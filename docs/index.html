<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Mobile Security</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Mobile Security</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#owasp_cheat_sheet_series">1. OWASP Cheat Sheet Series</a>
<ul class="sectlevel2">
<li><a href="#cryptographic_requirements">1.1. Cryptographic Requirements</a></li>
<li><a href="#certificate_pinning">1.2. Certificate Pinning</a></li>
<li><a href="#jailbreaking">1.3. Jailbreaking</a></li>
<li><a href="#mobile_testing">1.4. Mobile Testing</a></li>
</ul>
</li>
<li><a href="#owasp_mobile_verification_standard">2. OWASP Mobile Verification Standard</a>
<ul class="sectlevel2">
<li><a href="#table_keys">2.1. Table Keys</a></li>
<li><a href="#architecture_design_and_threat_modelling">2.2. Architecture, Design and Threat Modelling</a></li>
<li><a href="#data_storage_and_privacy">2.3. Data Storage and Privacy</a></li>
<li><a href="#cryptography">2.4. Cryptography</a></li>
<li><a href="#authentication_and_session_management">2.5. Authentication and Session Management</a></li>
<li><a href="#network_communication">2.6. Network Communication</a></li>
<li><a href="#environmental_interaction">2.7. Environmental Interaction</a></li>
<li><a href="#code_quality_and_build_settings">2.8. Code Quality and Build Settings</a></li>
<li><a href="#resiliency_against_reverse_engineering_requirements">2.9. Resiliency Against Reverse Engineering Requirements</a></li>
<li><a href="#other_mobile_vulnerabilities">2.10. Other Mobile Vulnerabilities</a></li>
</ul>
</li>
<li><a href="#android_security_guide">3. Android Security Guide</a>
<ul class="sectlevel2">
<li><a href="#kernel_security">3.1. Kernel Security</a></li>
<li><a href="#application_security">3.2. Application Security</a></li>
<li><a href="#authentication">3.3. Authentication</a></li>
<li><a href="#keystore">3.4. Keystore</a></li>
<li><a href="#trusted_execution_environment">3.5. Trusted Execution Environment</a></li>
</ul>
</li>
<li><a href="#cordova_security_guide">4. Cordova Security Guide</a>
<ul class="sectlevel2">
<li><a href="#whitelist">4.1. Whitelist</a></li>
<li><a href="#iframes_calback_id_mechanism">4.2. Iframes &amp; Calback ID Mechanism</a></li>
<li><a href="#certificate_pinning_2">4.3. Certificate Pinning</a></li>
<li><a href="#self_signed_certificates">4.4. Self-signed Certificates</a></li>
<li><a href="#encrypted_storage">4.5. Encrypted storage</a></li>
<li><a href="#general_tips">4.6. General Tips</a></li>
</ul>
</li>
<li><a href="#vetting_the_security_of_mobile_applications">5. Vetting the Security of Mobile Applications</a>
<ul class="sectlevel2">
<li><a href="#app_vetting_process">5.1. App Vetting Process</a></li>
<li><a href="#app_testing">5.2. App Testing</a></li>
<li><a href="#app_approval_rejection">5.3. App Approval/Rejection</a></li>
</ul>
</li>
<li><a href="#niap_mobile_app_vetting">6. NIAP Mobile App Vetting</a>
<ul class="sectlevel2">
<li><a href="#security_functional_requirements">6.1. Security Functional Requirements</a></li>
<li><a href="#security_assurance_requirements">6.2. Security Assurance Requirements</a></li>
<li><a href="#selection_based_security_functional_requirements">6.3. Selection-Based Security Functional Requirements</a></li>
<li><a href="#objective_security_functional_requirements">6.4. Objective Security Functional Requirements</a></li>
<li><a href="#optional_security_functional_requirements">6.5. Optional Security Functional Requirements</a></li>
</ul>
</li>
<li><a href="#guidelines_for_managing_the_security_of_mobile_devices_in_the_enterprise">7. Guidelines for Managing the Security of Mobile Devices in the Enterprise</a>
<ul class="sectlevel2">
<li><a href="#high_level_threats_and_vulnerabilities_for_mobile_devices">7.1. High-Level Threats and Vulnerabilities for Mobile Devices</a></li>
<li><a href="#technologies_for_mobile_device_management">7.2. Technologies for Mobile Device Management</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>All things mobile security related.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="owasp_cheat_sheet_series">1. OWASP Cheat Sheet Series</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a summary of notes taken from the <a href="https://www.owasp.org/index.php/OWASP_Cheat_">OWASP Cheat Sheet Series</a></p>
</div>
<div class="sect2">
<h3 id="cryptographic_requirements">1.1. Cryptographic Requirements</h3>
<div class="paragraph">
<p>The recommended minimal key lengths and algorithms by OWASP are outlined below.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key exchange</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diffie–Hellman with a minimum of 2048 bits</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HMAC-SHA2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA2 256 bits</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assymetric encryption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA 2048 bits</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Symmetric-key algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES 128 bits</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password Hashing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PBKDF2, Scrypt, Bcrypt</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="certificate_pinning">1.2. Certificate Pinning</h3>
<div class="paragraph">
<p>Pinning is the process of associating a host with their expected X509 certificate or public key.
Once a certificate or public key is known or seen for a host, the certificate or public key is associated or 'pinned' to the host. If more than one certificate or public key is acceptable, then the program holds a pinset. In this case, the advertised identity must match one of the elements in the pinset.</p>
</div>
<div class="sect3">
<h4 id="pinning_methods">1.2.1. Pinning Methods</h4>
<div class="paragraph">
<p>There are a number of ways you can pin the certificate to the client: the whole certificate, the public key of the certificate or a hash of the information.</p>
</div>
<div class="sect4">
<h5 id="certificate">Certificate</h5>
<div class="paragraph">
<p>The certificate is the easiest to pin to the client. However, one of the main downsides is having to update the app with a new certificate every time the cert expires, cert rotation or a CA is compromised.</p>
</div>
</div>
<div class="sect4">
<h5 id="public_key">Public Key</h5>
<div class="paragraph">
<p>Public key pinning is more flexible. As with a certificate, the program checks the extracted public key with its embedded copy of the public key. This will mean that if a cert is rotated or expires, and the public key doesn&#8217;t change in the process, you don&#8217;t need to update your applications with new certificates, as we are only concerned with a public key.
There are some extra steps necessary to extract the public key from a certificate and as the key is static and may violate key rotation policies.</p>
</div>
</div>
<div class="sect4">
<h5 id="hpkp_http_public_key_pinning">HPKP (HTTP Public Key Pinning)</h5>
<div class="paragraph">
<p>With HPKP, a number of public keys are pinned on the server. When a client visits the website for the first time, the client will store these pins.
On every future visit to the website, the client will make sure the public keys match the ones that they have stored locally. If the keys don&#8217;t match, it could mean that the CA was compromised or the keys have been rotated.
This is an example of dynamic pinning, where the entity to pin is retieved dynamically from the server, rather than being packaged or stored locally at development/build time.</p>
</div>
<div class="paragraph">
<p>A valid HPKP configuration must also include at least one backup key. Therefore, if something goes wrong, you can use the backup key instead.</p>
</div>
<div class="paragraph">
<p>The following is an example of the Public-Key-Pins HPKP Header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">Public-Key-Pins:
  pin-sha256="cUPcTAZWKaASuYWhhneDttWpY3oBAkE3h2+soZS7sWs=";
  pin-sha256="M8HztCzM3elUxkcjR2S5P4hhyBNf6lHkmjAHKhpGPWE=";
  max-age=5184000; includeSubDomains;
  report-uri="https://www.example.org/hpkp-report"</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The first <code>pin-sha256</code> is the production public key of the server.</p>
</li>
<li>
<p>The second <code>pin-sha256</code> is the backup key.</p>
</li>
<li>
<p>The <code>max-age</code> tells the client how long to store the keys for.</p>
</li>
<li>
<p>The <code>includeSubDomains</code> definition means that the key pinning is also valid for all subdomains.</p>
</li>
<li>
<p>The <code>report-uri</code> defines where you can report pin validation failures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some potentential issues with HPKP have been pointed out by <a href="https://blog.qualys.com/ssllabs/2016/09/06/is-http-public-key-pinning-dead">Qualys SSL Labs</a>.</p>
</div>
<div class="paragraph">
<p>An example of a helmet.js implementation guide for Node/Express is also available <a href="https://helmetjs.github.io/docs/hpkp/">here</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trustkit">1.2.2. TrustKit</h4>
<div class="paragraph">
<p><a href="https://github.com/datatheorem/TrustKit">TrustKit</a> for iOS and <a href="https://github.com/datatheorem/TrustKit-Android">TrustKit-Android</a> for Android allow SSL pinning for native mobile apps.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jailbreaking">1.3. Jailbreaking</h3>
<div class="paragraph">
<p>Jailbreaking or rooting is the process of gaining unauthorized access or elevated privileges on a system.</p>
</div>
<div class="sect3">
<h4 id="detecting_jailbreak">1.3.1. Detecting Jailbreak</h4>
<div class="ulist">
<ul>
<li>
<p>Identify 3rd party app stores (e.g. Cydia for iOS) or popular superuser applications.</p>
</li>
<li>
<p>Attempt to identify modified kernels by comparing certain system files that the application would have access to on a non-jailbroken device to known good file hashes. This technique can serve as a good starting point for detection.</p>
</li>
<li>
<p>Attempt to write a file outside of the application’s root directory. The attempt should fail for non-jailbroken devices as they don&#8217;t have the necessary permissions.</p>
</li>
<li>
<p>Generalizing, attempt to identify anomalies in the underlying system or verify the ability to execute privileged functions or methods.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mobile_testing">1.4. Mobile Testing</h3>
<div class="paragraph">
<p>The OWASP cheat sheet series also provides in-depth guides on how to analyse a mobile app for security risks.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.owasp.org/index.php/Android_Testing_Cheat_Sheet">Android Testing</a></p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/IOS_Developer_Cheat_Sheet">iOS Developer Guide</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="owasp_mobile_verification_standard">2. OWASP Mobile Verification Standard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a fork of the <a href="https://www.owasp.org/images/f/fe/MASVS_v0.9.3.pdf">OWASP Mobile Verification Standard</a>.</p>
</div>
<div class="sect2">
<h3 id="table_keys">2.1. Table Keys</h3>
<div class="paragraph">
<p><em>Category</em> - The type of work required for each item. Some enhancements have been made.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Manual Observation - A task that may only require manual observation. eg. confirming that no sensitive information is being stored in log files.</p>
</li>
<li>
<p>Tooling - A task that may require the use of tooling to carry out the task. eg. pentesting or creating threat models</p>
</li>
<li>
<p>Process - A task that may require some processes to be setup. eg. dependency checks.</p>
</li>
<li>
<p>Coding - A task that requires coding.</p>
</li>
<li>
<p>Keycloak - A task that can be carried out using Keycloak.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>OS/Framework Columns</em> - A column is allocated for each Mobile OS/Framework for any specific details for each item.</p>
</div>
</div>
<div class="sect2">
<h3 id="architecture_design_and_threat_modelling">2.2. Architecture, Design and Threat Modelling</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V1</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify all application components are identified and are known to be needed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual/Tooling Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the <a href="https://cordova.apache.org/docs/en/latest/config_ref/#plugin">config.xml</a> for unrequired components. This also includes any JS files required from a CDN or elsewhere in the index.html or equivalent of an application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify all third party components used by the mobile app, such as libraries and frameworks, are identified, and checked for known vulnerabilities.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual/Tooling Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the <a href="https://cordova.apache.org/docs/en/latest/config_ref/#plugin">config.xml</a> for vulnerable components manually or using dependency checker.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that security controls are never enforced only on the client side, but on the respective remote endpoints.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak/Server Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that a high-level architecture for the mobile app and all connected remote services has been defined and security has been addressed in that architecture.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual Observation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See 1.7</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that data considered sensitive in the context of the mobile app is clearly identified.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify all app components are defined in terms of the business functions and/or security functions they provide.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that a threat model for the mobile app and the associated remote services, which identifies potential threats and countermeasures, has been produced.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tooling Observation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A threat model diagram could be created (perhaps using OWASP Threat Dragon) where we can map out all the potential threats.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify all third party components have been assessed (associated risks) before being used or implemented. Additionally verify that a process is in place to ensure that each time a security update for a third party component is published, the change is inspected and the risk evaluated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual/Tooling/Process Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We could also look at using <a href="https://www.w3.org/TR/SRI/">subresource integrity</a> checks for requiring JS libraries from the internet/CDN within an index.html.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that all security controls have a centralized implementation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual/Keycloak Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that all components that are not part of the application but that the application relies on to operate, are clearly identified and the security implications of using those components are known.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual/Keycloak Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that there is an explicit policy for how cryptographic keys (if any) are managed, and the lifecycle of cryptographic keys is enforced. Ideally, follow a key management standard such as NIST SP 800-57.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that remote endpoints ensure that connecting clients use the current version of the mobile app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that security testing is performed as part of the development lifecycle. If some or all of the testing is automated, the configuration of the testing tools must be tailored to the specific app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual/Tooling Task/Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="data_storage_and_privacy">2.3. Data Storage and Privacy</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V2</th>
<th class="tableblock halign-left valign-top">Data Storage and Privacy</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that system credential storage facilities are used appropriately to store sensitive data, such as user credentials or cryptographic keys.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ie. Securely storing content on the device, but also only storing data in the correct features on the OS, and not putting sensitive content where you shouldn’t or using an OS feature for the wrong purpose.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For Android we should use the Android <a href="https://developer.android.com/training/articles/keystore.html">Keystore</a>.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We could look at using the following <a href="https://www.npmjs.com/package/cordova-plugin-secure-key-store">cordova plugin</a> to provide secure storage.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that no sensitive data is written to application logs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that no sensitive data is shared with third parties unless it is a necessary part of the architecture.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the keyboard cache is disabled on text inputs that process sensitive data.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the clipboard is deactivated on text fields that may contain sensitive data.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that no sensitive data is exposed via IPC mechanisms.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that no sensitive data, such as passwords and credit card numbers, is exposed through the user interface or leaks to screenshots.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We should ensure that no sensitive information is shown as default in the mobile. This should be blurred/hidden behind asterisks instead. We should also ensure that screenshotting functionality is being blocked by the app.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that no sensitive data is included in backups.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We should ensure that the the allowBackup setting is disabled to prevent app data recovery via backups.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We should ensure that the the allowBackup setting is disabled to prevent app data recovery via backups.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app removes sensitive data from views when backgrounded.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabling snapshotting might be sufficient. This will blur/blank-out the screenshot of the application when displayed in the app switcher on the phone.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This could be disabled for iOS using the following <a href="https://www.npmjs.com/package/cordova-plugin-blurred-snapshot">cordova plugin</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app does not hold sensitive data in memory longer than necessary, and memory is cleared explicitly after use.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app enforces a minimum device-access-security policy, such as requiring the user to set a device passcode.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We could use the following <a href="https://github.com/ABarak64/Cordova-Screen-Lock-Enabled">cordova plugin</a> to check if a device passcode/lock screen has been set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app educates the user about the types of personally identifiable information processed, as well as security best practices the user should follow in using the app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual Observation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="cryptography">2.4. Cryptography</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V3</th>
<th class="tableblock halign-left valign-top">Cryptography</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app does not rely on symmetric cryptography with hardcoded keys as a sole method of encryption.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual Observation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This should be covered by 2.1</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app uses proven implementations of cryptographic primitives.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app uses cryptographic primitives that are appropriate for the particular use-case, configured with parameters that adhere to industry best practices.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app does not use cryptographic protocols or algorithms that are widely considered deprecated for security purposes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app doesn&#8217;t re-use the same cryptographic key for multiple purposes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that all random values are generated using a sufficiently secure random number generator.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="authentication_and_session_management">2.5. Authentication and Session Management</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V4</th>
<th class="tableblock halign-left valign-top">Authentication and Session Management</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that if the app provides users with access to a remote service, an acceptable form of authentication such as username/password authentication is performed at the remote endpoint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the remote endpoint uses randomly generated access tokens to authenticate client requests without sending the user&#8217;s credentials.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the remote endpoint terminates the existing session when the user logs out.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak has its own logout flow on the server to terminate a user’s session.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that a password policy exists and is enforced at the remote endpoint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak has an in-depth password policy manager to</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the remote endpoint implements an exponential back-off, or temporarily locks the user account, when incorrect authentication credentials are submitted an excessive number of times.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak will allow you to both temporarily and permanently lock out a user after a specified number of failed login attempts.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that biometric authentication, if any, is not event-bound (i.e. using an API that simply returns "true" or "false"). Instead, it is based on unlocking the keychain/keystore.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that sessions are terminated at the remote endpoint after a predefined period of inactivity.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that a second factor of authentication exists at the remote endpoint and the 2FA requirement is consistently enforced.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak can be setup to enforce 2FA. This can also be done on user creation so when the new user logs in for the first time, the second layer of protection will already be enforced.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that step-up authentication is required to enable actions that deal with sensitive data or transactions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We should ensure that Keycloak authentication should be performed again when carrying out a sensitive/important action in the mobile app.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app informs the user of all login activities with his or her account. Users are able view a list of devices used to access the account, and to block specific devices.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak/Coding Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak supports viewing of sessions/IP addresses, but doesn’t currently allow to see user-agents/geo locations of the device.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="network_communication">2.6. Network Communication</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V5</th>
<th class="tableblock halign-left valign-top">Network Communication</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that data is encrypted on the network using TLS. The secure channel is used consistently throughout the app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the TLS settings are in line with current best practices, as far as they are supported by the mobile operating system.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app verifies the X.509 certificate of the remote endpoint when the secure channel is established. Only certificates signed by a valid CA are accepted.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This could be carried out with client cert auth in keycloak.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app either uses its own certificate store, or pins the endpoint certificate or public key, and subsequently does not establish connections with endpoints that offer a different certificate or key, even if signed by a trusted CA.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak/Coding Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public key pinning might be better than full certificate pinning as handling cert renewals, compromises may be easier to work with, but requires more investigation. We should also consider HPKP.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/datatheorem/TrustKit-Android">TrustKit</a> for Android can be used for certificate pinning.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/datatheorem/TrustKit">TrustKit</a> for iOS can be user for certificate pinning.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Secure HTTP <a href="http://plugins.telerik.com/cordova/plugin/secure-http">cordova plugin</a> will allow certificate pinning.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app doesn&#8217;t rely on a single insecure communication channel (email or SMS) for critical operations, such as enrollments and account recovery.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak has a credentials reset flow which allows you to configure how password/credential resets should be carried out.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app uses some form of whitelisting to control access to external domains.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We should follow the <a href="https://cordova.apache.org/docs/en/7.x/guide/appdev/whitelist/index.html">whitelist guide</a> for controlling external domain access in Cordova.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="environmental_interaction">2.7. Environmental Interaction</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V6</th>
<th class="tableblock halign-left valign-top">Environmental Interaction</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app only requires the minimum set of permissions necessary.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Process Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the <a href="https://developer.android.com/guide/topics/manifest/manifest-intro.html">AndroidManifest.xml</a> for unrequired permissions..</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the <a href="https://cordova.apache.org/docs/en/latest/config_ref/#plugin">config.xml</a> for unrequired permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that all inputs from external sources and the user are validated and if necessary sanitized. This includes data received via the UI, IPC mechanisms such as intents, custom URLs, and network sources.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We should ensure that we are HTML encoding data that is coming from the server if it’s being rendered as html.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app does not export sensitive functionality via custom URL schemes, unless these mechanisms are properly protected.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app does not export sensitive functionality through IPC facilities, unless these mechanisms are properly protected.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that JavaScript is disabled in WebViews unless explicitly required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that WebViews are configured to allow only the minimum set of protocol handlers required (ideally, only https). Potentially dangerous handlers, such as file, tel and app-id, are disabled.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app does not load user-supplied local resources into WebViews.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that if Java objects are exposed in a WebView, verify that the WebView only renders JavaScript contained within the app package.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some content security policies might be of use here to limit what javascript can be executed from sources.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that object serialization, if any, is implemented using safe serialization APIs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app detects whether it is being executed on a rooted or jailbroken device. Depending on the business requirement, users are warned, or the app is terminated if the device is rooted or jailbroken.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For both iOS and Android we could use the cordova-plugin-iroot.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="code_quality_and_build_settings">2.8. Code Quality and Build Settings</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V7</th>
<th class="tableblock halign-left valign-top">Code Quality and Build Settings</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app is signed and provisioned with valid certificate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Process/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app has been built in release mode, with settings appropriate for a release build (e.g. non-debuggable).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that debugging symbols have been removed from native binaries.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that debugging code has been removed, and the app does not log verbose errors or debugging messages.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app catches and handles possible exceptions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that error handling logic in security controls denies access by default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that in unmanaged code, memory is allocated, freed and used securely.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free security features offered by the toolchain, such as byte-code minification, stack protection, PIE support and automatic reference counting, are activated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="resiliency_against_reverse_engineering_requirements">2.9. Resiliency Against Reverse Engineering Requirements</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V8</th>
<th class="tableblock halign-left valign-top">Resiliency Against Reverse Engineering Requirements</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app implements two or more functionally independent methods of root detection and responds to the presence of a rooted device either by alerting the user or terminating the app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation will be covered by 6.10</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app implements multiple functionally independent debugging defenses that, in context of the overall protection scheme, force adversaries to invest significant manual effort to enable debugging. All available debugging protocols must be covered (e.g. JDWP and native).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It would be a good idea here to crash the debugger/browser where possible.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app detects, and responds to, tampering with executable files and critical data.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app detects the presence of widely used reverse engineering tools, such as code injection tools, hooking frameworks and debugging servers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app detects, and response to, being run in an emulator using any method.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app detects, and responds to, modifications of process memory, including relocation table patches and injected code.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app implements multiple different responses to tampering, debugging and emulation (requirements 9.2 - 9.6), including stealthy responses that don&#8217;t simply terminate the app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify all executable files and libraries belonging to the app are either encrypted on the file level and/or important code and data segments inside the executables are encrypted or packed. Trivial static analysis should not reveal important code or data.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that obfuscating transformations and functional defenses are interdependent and well-integrated throughout the app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app implements a 'device binding' functionality when a mobile device is treated as being trusted. Verify that the device fingerprint is derived from multiple device properties.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that the app uses multiple functionally independent means of emulator detection that, in context of the overall protection scheme, force adversaries to invest significant manual effort to run the app in an emulator (supersedes requirement 8.5).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that if the architecture requires sensitive information be stored on the device, the app only runs on operating system versions and devices that offer hardware-backed key storage. Alternatively, the information is protected using obfuscation. Considering current published research, the obfuscation type and parameters are sufficient to cause significant manual effort to reverse engineers seeking to comprehend or extract the sensitive data.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that if the architecture requires sensitive computations be performed on the client-side, these computations are isolated from the operating system by using a hardware-based SE or TEE. Alternatively, the information is protected using obfuscation. Considering current published research, the obfuscation type and parameters are sufficient to cause significant manual effort to reverse engineers seeking to comprehend the sensitive portions of the code and/or data.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding Task</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="other_mobile_vulnerabilities">2.10. Other Mobile Vulnerabilities</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">V9</th>
<th class="tableblock halign-left valign-top">Other Mobile Vulnerabilities</th>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Comments</th>
<th class="tableblock halign-left valign-top">Android</th>
<th class="tableblock halign-left valign-top">iOS</th>
<th class="tableblock halign-left valign-top">Cordova</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that Function Level Access Control is being enforced</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limited to webviews.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verify that there are no insecure direct object references.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coding/Observation Task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limited to webviews.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="android_security_guide">3. Android Security Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a summary of the <a href="https://source.android.com/security/">Android Security Guide</a>.</p>
</div>
<div class="sect2">
<h3 id="kernel_security">3.1. Kernel Security</h3>
<div class="sect3">
<h4 id="application_sandbox">3.1.1. Application Sandbox</h4>
<div class="paragraph">
<p>Android uses the UNIX user-based protection to identify and isolate running applications.
The Android system assigns a unique UID (User ID) to each Android application and runs the application as a certain user in a separate process.
By default, applications cannot interact with each other. This is due to the user privileges being different for each application.
Memory corruption errors in one application will not lead to corruption in other applications, due to this isolation.</p>
</div>
<div class="paragraph">
<p>However, if the <code>android:sharedUserId</code> attribute is set (in the App Manifest) to the same value for two or more applications, they will all share the same User ID — provided that their certificate sets are identical.
Applications with the same user ID can access each other&#8217;s data and also run in the same process.</p>
</div>
</div>
<div class="sect3">
<h4 id="filesystem_permissions">3.1.2. Filesystem Permissions</h4>
<div class="paragraph">
<p>The filesystem permissions ensure that one user cannot alter or read another user&#8217;s files. In the context of Android, this means that one application, cannot access or alter the data for another application, unless they explicitly allow it.</p>
</div>
</div>
<div class="sect3">
<h4 id="device_rooting">3.1.3. Device Rooting</h4>
<div class="paragraph">
<p>By default, only the kernel and small number of core applications run using root permissions. Root permissions will allow you full access to all applications on the device, as well as their applications data.</p>
</div>
<div class="paragraph">
<p>Encrypting data with a key stored on the device will not protect the application from a root user.
Applications could use a key stored off-device, but this approach will only provide temporary protection while the key is not present on the device.
At some point the key must be provided to the application and it then becomes accessible to root users.</p>
</div>
</div>
<div class="sect3">
<h4 id="filesystem_encryption">3.1.4. Filesystem Encryption</h4>
<div class="paragraph">
<p>A number of different filesytem encryption approaches have been used by different versions of Android.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Android 3.0</em></p>
<div class="ulist">
<ul>
<li>
<p>Full filesystem encryption in the kernel.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Android 5.0</em></p>
<div class="ulist">
<ul>
<li>
<p>Full-disk encryption which uses a single key—protected with the user’s device password—to protect the whole of a device’s userdata partition.</p>
</li>
<li>
<p>Upon boot, users must provide their credentials before any part of the disk is accessible.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Android 7.0</em></p>
<div class="ulist">
<ul>
<li>
<p>File-based encryption allows different files to be encrypted with different keys that can be unlocked independently.</p>
</li>
<li>
<p>The Direct Boot feature allows encrypted devices to boot straight to the lock screen.</p>
</li>
<li>
<p>This makes profiles more secure because it allows more than one user to be protected at a time as the encryption is no longer based solely on a boot time password.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="application_security">3.2. Application Security</h3>
<div class="sect3">
<h4 id="certificate_authorities">3.2.1. Certificate Authorities</h4>
<div class="paragraph">
<p>Android includes a set of installed system Certificate Authorities, which are trusted system-wide.
Devices running Android 7.0 and above will have an Android stock set of system CAs as device manufacturers supplied CA&#8217;s are no longer permitted.</p>
</div>
</div>
<div class="sect3">
<h4 id="application_signing">3.2.2. Application Signing</h4>
<div class="paragraph">
<p>APK Signing will allow a developer to identify the author of the application.
The signed application certificate defines which user id is associated with which application.
The application signing ensures that applications cannot access each other except through a well-defined IPC (Inter-process communication).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authentication">3.3. Authentication</h3>
<div class="paragraph">
<p>Two key pieces make up Authentication &amp; Key Storage from Android 6.0.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Android Keystore</em> - Cryptographic key storage which also provides standard crypto actions.</p>
</li>
<li>
<p><em>Authentication Components</em> - Assert the user&#8217;s presence and/or provide user authentication.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are two authentication components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Gatekeeper</em> - Pin, Pattern &amp; Password Authentication</p>
</li>
<li>
<p><em>Fingerprint</em>  - Fingerprint Authentication</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The two authentication components work with the Keystore and (other components) to support the use of hardware-backed authentication tokens or AuthTokens.</p>
</div>
<div class="sect3">
<h4 id="enrollment">3.3.1. Enrollment</h4>
<div class="paragraph">
<p>On first boot of the device, the user must initially enroll a PIN/pattern/password with Gatekeeper.
This is known as enrollment.
This is necessary to to create the User&#8217;s SID (User Secure Identifier) which is a 64-bit randomly generated ID.</p>
</div>
<div class="paragraph">
<p>This SID is cryptographically bound to the user&#8217;s password, so when a successful authentication takes place, the AuthTokens will contain the User SID for that password.</p>
</div>
</div>
<div class="sect3">
<h4 id="authentication_process">3.3.2. Authentication Process</h4>
<div class="paragraph">
<p>Once a user has set up a credential (eg. a Pattern lock) and they have received their User SID (Secure User Id), they are now ready to authenticate.</p>
</div>
<div class="paragraph">
<p>As part of Android authentication, an operating system (known as Trusty OS) runs on a processor intended to provide a TEE (Trusted Execution Environment).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/android-authentication-flow.png" alt="600" width="600">
</div>
<div class="title">Figure 1: Android Authentication Process</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Authentication begins when a user enters a Gatekeeper credential (eg. a Pin, Pattern, Password) or a Fingerprint.</p>
</li>
<li>
<p>The next step involves either the Gatekeeper daemon (gatekeeperd) or the Fingerprint daemon (fingerprintd) depending on what authentication credential is used.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>gatekeeperd</code> daemon will send a hash of the password/pin/pattern it received in step 1, to its counterpart <code>gatekeeper</code> in the TEE (TEE OS).</p>
</li>
<li>
<p>Alternatively, the <code>fingerprintd</code> daemon sends the data to its <code>fingerprint</code> counterpart in the TEE.</p>
</li>
<li>
<p>If authentication in the TEE (TEE OS) is successful, <code>gatekeeper</code> or <code>fingerprint</code> in the TEE sends an AuthToken containing the corresponding User SID, signed with the AuthToken HMAC key, to its counterpart in the Android OS.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Remember that the SID is cryptographically bound to the user&#8217;s password.</p>
</li>
<li>
<p>The HMAC is used for message integrity.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The <code>gatekeeperd</code> or <code>fingerprintd</code> daemon receives a signed AuthToken from the TEE and passes the AuthToken to the <code>keystore service</code>.</p>
</li>
<li>
<p>Lastly, the <code>keystore service</code> passes the AuthTokens received from <code>gatekeeperd</code> and <code>fingerprintd</code> to the <code>keymaster</code>.
The AuthToken is verified with the <code>AuthToken HMAC key</code> which was previously shared with the <code>gatekeeper</code> and <code>fingerprint</code> "trustlets" in step 2.
The <code>keymaster</code> trusts the timestamp in the token as the last authentication time and bases a key release decision (to allow an app to use the key) on the timestamp.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="keystore">3.4. Keystore</h3>
<div class="paragraph">
<p>The Android Keystore system allows storage of cryptographic keys inside a container to make it more difficult to extract them from a device.
Once keys are in the keystore, they can be used for cryptographic operations with the key material remaining non-exportable.</p>
</div>
</div>
<div class="sect2">
<h3 id="trusted_execution_environment">3.5. Trusted Execution Environment</h3>
<div class="paragraph">
<p>A TEE processor is generally a separate microprocessor or a virtualized instance of the main processor.
The TEE processor is isolated from the rest of the system using memory and I/O protection mechanisms supported by the hardware.</p>
</div>
<div class="paragraph">
<p>TEE is necessary as the main processor on mobile devices is considered "untrusted".
It is not allowed access to certain areas of RAM or where other device-specific cryptographic keys are stored.
Applications running on the main processor will therefore delegate any operations that require use of secret/sensitive data to the TEE processor.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cordova_security_guide">4. Cordova Security Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a summary of the <a href="https://cordova.apache.org/docs/en/latest/guide/appdev/security/">Cordova Security Guide</a>.</p>
</div>
<div class="sect2">
<h3 id="whitelist">4.1. Whitelist</h3>
<div class="paragraph">
<p>Domain whitelisting is a security model that controls access to external domains over which your application has no control. Cordova provides a configurable security policy to define which external sites may be accessed. By default, new apps are configured to allow access to any site. Before moving your application to production, you should formulate a whitelist and allow access to specific network domains and subdomains.</p>
</div>
<div class="paragraph">
<p>Be aware that some websites may automatically redirect from their home page to a different url, such as using https protocol or to a country-specific domain. For example <code><a href="http://www.google.com" class="bare">http://www.google.com</a></code> will redirect to use SSL/TLS at <code><a href="https://www.google.com" class="bare">https://www.google.com</a></code>, and then may further redirect to a geography such as <code><a href="https://www.google.co.uk" class="bare">https://www.google.co.uk</a></code>. Such scenarios may require modified or additional whitelist entries beyond your initial requirement</p>
</div>
<div class="paragraph">
<p>Note that the whitelist applies only to the main Cordova webview, and does not apply to an <a href="https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-inappbrowser/">InAppBrowser</a> webview or opening links in the system web browser.</p>
</div>
</div>
<div class="sect2">
<h3 id="iframes_calback_id_mechanism">4.2. Iframes &amp; Calback ID Mechanism</h3>
<div class="paragraph">
<p>If content is served in an iframe from a whitelisted domain, that domain will have access to the native Cordova bridge. This means that if you whitelist a third-party advertising network and serve those ads through an iframe, it is possible that a malicious ad will be able to break out of the iframe and perform malicious actions. Because of this, you should generally not use iframes unless you control the server that hosts the iframe content.</p>
</div>
</div>
<div class="sect2">
<h3 id="certificate_pinning_2">4.3. Certificate Pinning</h3>
<div class="paragraph">
<p>Cordova does not support true certificate pinning. The main barrier to this is a lack of native APIs in Android for intercepting SSL connections to perform the check of the server&#8217;s certificate.
Since Apache Cordova is meant to offer consistent APIs across multiple platforms, not having a capability in a major platform breaks that consistency.</p>
</div>
<div class="paragraph">
<p>There are ways to approximate certificate pinning, such as checking the server&#8217;s public key (fingerprint) is the expected value when your application starts or at other various times during your application&#8217;s lifetime. There are third-party plugins available for Cordova that can do that. However, this is not the same as true certificate pinning which automatically verifies the expected value on every connection to the server.</p>
</div>
</div>
<div class="sect2">
<h3 id="self_signed_certificates">4.4. Self-signed Certificates</h3>
<div class="paragraph">
<p>Using self-signed certificates on your server is not recommended.
If you desire SSL, then it is highly recommended that your server have a certificate that has been properly signed by a well-known CA (certificate authority).
The inability to do true certificate pinning makes this important.
The reason is that accepting self-signed certificates bypasses the certificate chain validation, which allows any server certificate to be considered valid by the device.</p>
</div>
</div>
<div class="sect2">
<h3 id="encrypted_storage">4.5. Encrypted storage</h3>
<div class="paragraph">
<p>For encrypted storage, you could consider using one of a number of secure storage plugins for Cordova.
The <a href="https://www.npmjs.com/package/cordova-plugin-secure-key-store">cordova-plugin-secure-key-store</a> plugin uses the Android Keystore and the iOS Keychain for stores sensitive data.</p>
</div>
</div>
<div class="sect2">
<h3 id="general_tips">4.6. General Tips</h3>
<div class="sect3">
<h4 id="use_inappbrowser_for_outside_links">4.6.1. Use InAppBrowser for outside links</h4>
<div class="paragraph">
<p>Use the InAppBrowser when opening links to any outside website. This is much safer than whitelisting a domain name and including the content directly in your application because the InAppBrowser will use the native browser&#8217;s security features and will not give the website access to your Cordova environment. Even if you trust the third party website and include it directly in your application, that third party website could link to malicious web content.</p>
</div>
<div class="paragraph">
<p>If you want all page loads in your app to go through the InAppBrowser, you can simply hook <code>window.open</code> during initialization. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>document.addEventListener("deviceready", onDeviceReady, false);
function onDeviceReady() {
    window.open = cordova.InAppBrowser.open;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validate_all_user_input">4.6.2. Validate all User Input</h4>
<div class="paragraph">
<p>Always validate any and all input that your application accepts.
This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>usernames</p>
</li>
<li>
<p>passwords</p>
</li>
<li>
<p>dates</p>
</li>
<li>
<p>uploaded media etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because an attacker could manipulate your HTML and JS assets (either by decompiling your application or using debugging tools like chrome://inspect), this validation should also be performed on your server, especially before handing the data off to any backend service.</p>
</div>
<div class="paragraph">
<p>Other sources where data should be validated include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User Documents</p>
</li>
<li>
<p>Contacts</p>
</li>
<li>
<p>Push Notifications</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="do_not_cache_sensitive_data">4.6.3. Do not cache sensitive data</h4>
<div class="paragraph">
<p>If usernames, password, geolocation information, and other sensitive data is cached, then it could potentially be retrieved later by an unauthorized user or application.</p>
</div>
</div>
<div class="sect3">
<h4 id="do_not_assume_that_your_source_code_is_secure">4.6.4. Do not assume that your source code is secure</h4>
<div class="paragraph">
<p>Since a Cordova application is built from HTML and JavaScript assets that get packaged in a native container, you should not consider your code to be secure.
It is possible to reverse engineer a Cordova application to recover sensitive app data or hardcoded keys etc.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="vetting_the_security_of_mobile_applications">5. Vetting the Security of Mobile Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a summary of notes taken from the <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-163.pdf">NIST Vetting the Security of Mobile Applications</a>.</p>
</div>
<div class="sect2">
<h3 id="app_vetting_process">5.1. App Vetting Process</h3>
<div class="sect3">
<h4 id="general_process">5.1.1. General Process</h4>
<div class="paragraph">
<p>In an enterprise environment, before the mobile apps are deployed to the devices, they needs to be vetted. The process works like this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The apps are submitted to the administrator.</p>
</li>
<li>
<p>The administrator submit the app for testing.
The app testing process will use both static analysis and dynamic analysis services or tools to identity poteintial vulnerabilities of the apps.
It should also generate reports about those vulnerabilities and produce risk assessments.</p>
</li>
<li>
<p>The generated reports will be submitted to an auditor.
Based on the reports the auditor will then submit the recommendation to the approver.</p>
</li>
<li>
<p>Approver will either approve or reject the app.</p>
</li>
<li>
<p>If the app is approved, the administrator will deploy the app. Otherwise the administrator will reject the app.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following diagram can be used to describe the process:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/mobile-app-vetting.png" alt="600" width="600">
</div>
</div>
<div class="paragraph">
<p>Further note that although app vetting processes may vary among organizations, organizations should strive to implement a process that is repeatable, efficient, consistent, and that limits errors.</p>
</div>
</div>
<div class="sect3">
<h4 id="planning_the_vetting_process">5.1.2. Planning the Vetting Process</h4>
<div class="paragraph">
<p>Before an organization can implement an app vetting process, it is necessary for the organization to first</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>develop app security requirements</p>
</li>
<li>
<p>understand the limitations of app vetting, and</p>
</li>
<li>
<p>procure a budget and staff for supporting the app vetting process.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="recommendation">5.1.3. Recommendation</h4>
<div class="ulist">
<ul>
<li>
<p>Perform a risk analysis to understand and document the potential security impact of mobile apps on the organization’s computing, networking, and data resources.</p>
</li>
<li>
<p>Review and document the mobile device hardware and operating system security controls, for example an encrypted file system, and identify which security and privacy requirements can be addressed by the mobile device itself.</p>
</li>
<li>
<p>Review and document mobile enterprise security technologies, such as Mobile Device Management (MDM) solutions, and identify which security and privacy requirements can be addressed by these technologies.</p>
</li>
<li>
<p>Review the organization’s mobile security architecture and understand what threats are mitigated through the technical and operational controls. Identify potential security and privacy risks that are not mitigated through these technical and operational controls.</p>
</li>
<li>
<p>Develop organizational app security requirements by identifying general and context-sensitive requirements.</p>
</li>
<li>
<p>Educate organizational staff on the limitations of app vetting and the value of human involvement in an app vetting process.</p>
</li>
<li>
<p>Procure an adequate budget for performing an app vetting process.</p>
</li>
<li>
<p>Hire personnel, particularly auditors, with appropriate expertise.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="app_testing">5.2. App Testing</h3>
<div class="paragraph">
<p>General app security requirements include:</p>
</div>
<div class="sect3">
<h4 id="testing_requirements">5.2.1. Testing Requirements</h4>
<div class="sect4">
<h5 id="enabling_authorized_functionality">Enabling authorized functionality</h5>
<div class="sect5">
<h6 id="requirement">Requirement</h6>
<div class="paragraph">
<p>The app must work as described; all buttons, menu items, and other interfaces must work. Error conditions must be handled gracefully, such as when a service or function is unavailable (e.g., disabled, unreachable, etc.)</p>
</div>
</div>
<div class="sect5">
<h6 id="examples">Examples</h6>
<div class="ulist">
<ul>
<li>
<p>Testing the UI</p>
</li>
<li>
<p>Usage of the physical sensors on the device</p>
</li>
<li>
<p>Usage of Telephony and SMS messages of the device</p>
</li>
<li>
<p>Usage of the device identifier or PII (personally identifiable information)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="preventing_unauthorized_functionality">Preventing unauthorized functionality</h5>
<div class="sect5">
<h6 id="requirement_2">Requirement</h6>
<div class="paragraph">
<p>Unauthorized functionality, such as data exfiltration performed by malware, must not be supported.</p>
</div>
</div>
<div class="sect5">
<h6 id="examples_2">Examples</h6>
<div class="ulist">
<ul>
<li>
<p>Malicious malwares that can</p>
<div class="ulist">
<ul>
<li>
<p>exfiltrating confidential information or PII to a third party</p>
</li>
<li>
<p>defrauding the user by sending premium SMS messages</p>
</li>
<li>
<p>injection of fake websites into the victim’s browser</p>
</li>
<li>
<p>the use of banner ads that may be presented in a manner which causes the user to unintentionally select ads that may attempt to deceive the user</p>
</li>
</ul>
</div>
</li>
<li>
<p>Use open source or commercially available malware detection and analysis tools to identify known or new form of malwares</p>
</li>
<li>
<p>Are there communications with disreputable websites, domains, servers, etc</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="limiting_permissions">Limiting permissions</h5>
<div class="sect5">
<h6 id="requirement_3">Requirement</h6>
<div class="paragraph">
<p>Apps should have only the minimum permissions necessary and should only grant other applications the necessary permissions.</p>
</div>
</div>
<div class="sect5">
<h6 id="examples_3">Examples</h6>
<div class="ulist">
<ul>
<li>
<p>File input/output (I/O) and removable storage</p>
<div class="ulist">
<ul>
<li>
<p>file scanning or access to files that are not part of an app’s own directory could be an indicator of malicious activity or bad coding practice</p>
</li>
</ul>
</div>
</li>
<li>
<p>Privileged commands</p>
<div class="ulist">
<ul>
<li>
<p>Apps may possess the ability to invoke lower-level command line programs, which may allow access to low-level structures, such as the root directory, or may allow access to sensitive commands.</p>
</li>
</ul>
</div>
</li>
<li>
<p>APIs</p>
<div class="ulist">
<ul>
<li>
<p>The app only uses designated APIs from the vendor-provided software development kit (SDK) and uses them properly; no other API calls are permitted</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="protecting_sensitive_data">Protecting sensitive data</h5>
<div class="sect5">
<h6 id="requirement_4">Requirement</h6>
<div class="paragraph">
<p>Apps that collect, store, and transmit sensitive data should protect the confidentiality and integrity of this data.
This category includes preserving privacy, such as asking permission to use personal information and using it only for authorized purposes</p>
</div>
</div>
<div class="sect5">
<h6 id="examples_4">Examples</h6>
<div class="ulist">
<ul>
<li>
<p>Usage of invalid cryptography modules. See <a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140val-all.htm">list of FIPS (Federal Information Processing Standards) validated modules</a></p>
</li>
<li>
<p>Cryptography implementations must also be maintained in accordance with approved practices.</p>
<div class="ulist">
<ul>
<li>
<p>Cryptographic key management is often performed improperly, leading to exploitable weaknesses. See <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt3r1.pdf">NIST Recommendation for Key Management</a></p>
</li>
<li>
<p>The failure to properly validate digital certificates, leaving communications protected by these certificates subject to man-in-themiddle attacks.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Privacy considerations need to be taken into account for apps that handle PII, including mobile-specific personal information like location data and pictures taken by onboard cameras, as well as the broadcast ID of the device.</p>
</li>
<li>
<p>Data leakage</p>
<div class="ulist">
<ul>
<li>
<p>Through unauthorized network connections.</p>
</li>
<li>
<p>Shared system-level logs, where multiple apps log their security events to a single log file</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="securing_app_code_dependencies">Securing app code dependencies</h5>
<div class="sect5">
<h6 id="requirement_5">Requirement</h6>
<div class="paragraph">
<p>The app must use any dependencies, such as on libraries, in a reasonable manner and not for malicious reasons.
Specifically, an app should properly use other bodies of code, such as libraries, only when needed, and not to attempt to obfuscate malicious activity</p>
</div>
</div>
<div class="sect5">
<h6 id="examples_5">Examples</h6>
<div class="ulist">
<ul>
<li>
<p>Native Methods</p>
<div class="ulist">
<ul>
<li>
<p>Native method calls are typically calls to a library function that has already been loaded into memory.</p>
</li>
<li>
<p>However, can provide a level of obfuscation that impacts the ability to perform analysis of the app.</p>
</li>
</ul>
</div>
</li>
<li>
<p>External Libraries and Classes</p>
<div class="ulist">
<ul>
<li>
<p>Third-party libraries and classes can be closed source, can have selfmodifying code, or can execute unknown server-side code.</p>
</li>
<li>
<p>Legitimate uses for loaded libraries and classes might be for the use of a cryptographic library or a graphics API.</p>
</li>
<li>
<p>Tools are available that can list libraries, and these libraries can then be searched for in vulnerability databases to determine if they have known weaknesses.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Dynamic Behavior</p>
<div class="ulist">
<ul>
<li>
<p>The key point here is the need to know where data used by an app originates from and knowing whether and how it gets sanitized.</p>
</li>
<li>
<p>It is critical to recognize that data downloaded from an external source is particularly dangerous as a potential exploit vector unless it is clear how the app prevents insecure behaviors resulting from data from a source not trusted by the organization using the app.</p>
</li>
<li>
<p>Requiring some level of risk-tolerance mitigation.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Inter-Application Communications</p>
<div class="ulist">
<ul>
<li>
<p>Be aware of situations where an app is using nonhuman entities to make API calls to other devices, to communicate with third-party services, or to otherwise interact with other systems.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="testing_app_updates">Testing app updates</h5>
<div class="sect5">
<h6 id="requirement_6">Requirement</h6>
<div class="paragraph">
<p>New versions of the app must be tested to identify any new weaknesses.</p>
</div>
</div>
<div class="sect5">
<h6 id="examples_6">Examples</h6>
<div class="ulist">
<ul>
<li>
<p>All apps, as well as their updates, should go through a software assurance vetting process, because each new version of an app can introduce new unintentional weaknesses or unreliable code.</p>
</li>
<li>
<p>But devices can install updates automatically, or users can install updates from somewhere else</p>
<div class="ulist">
<ul>
<li>
<p>Disabling all automatic updates</p>
</li>
<li>
<p>Only permitting use of an organization-provided app store</p>
</li>
<li>
<p>Enabling MDM mobile application management features</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="testing_approaches">5.2.2. Testing Approaches</h4>
<div class="sect4">
<h5 id="correctness_testing">Correctness Testing</h5>
<div class="ulist">
<ul>
<li>
<p>Software correctness testing is the process of executing a program with the intent of finding errors.</p>
</li>
<li>
<p>Although software correctness testing is aimed primarily at improving quality assurance, verifying and validating described functionality, or estimating reliability, it can also help to reveal potential security vulnerabilities since such vulnerabilities often have a negative effect on the quality, functionality, and reliability of the software.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="source_code_versus_binary_code">Source Code Versus Binary Code</h5>
<div class="ulist">
<ul>
<li>
<p>When source code is available, such as in the case of an open source app, a variety of tools can be used to analyze it.</p>
<div class="ulist">
<ul>
<li>
<p>Reviewers should generally use automated static analysis tools whether they are conducting an automated or a manual review, and they should express their findings in terms of Common Weakness Enumeration (CWE) identifiers or some other widely accepted nomenclature.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="static_versus_dynamic_analysis">Static Versus Dynamic Analysis</h5>
<div class="ulist">
<ul>
<li>
<p>Organizations should consider the technical trade-off differences between what static and dynamic tools offer and balance their usage given the organization’s software assurance goals.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="automated_tools">Automated Tools</h5>
<div class="paragraph">
<p>Classes of automated tools include</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Simulators</p>
</li>
<li>
<p>Remote Device Access</p>
</li>
<li>
<p>Automated Testing</p>
<div class="ulist">
<ul>
<li>
<p>User Interface-Driven Testing</p>
</li>
<li>
<p>Data-Driven Testing</p>
</li>
<li>
<p>Fuzzing</p>
</li>
<li>
<p>Network-Level Testing</p>
</li>
</ul>
</div>
</li>
<li>
<p>Test Automation</p>
</li>
<li>
<p>Static Tools</p>
<div class="ulist">
<ul>
<li>
<p>Static Analysis Tools</p>
</li>
<li>
<p>Metrics Tools</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Organizations will need to use multiple automated tools to meet their testing requirements.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sharing_results">5.2.3. Sharing Results</h4>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://nvd.nist.gov/">National Vulnerability Database (NVD)</a> is the U.S. government repository of standards-based
vulnerability management data represented using the <a href="https://scap.nist.gov/">Security Content Automation Protocol (SCAP)</a></p>
<div class="ulist">
<ul>
<li>
<p>The NVD includes databases of security checklists, security-related software flaws, misconfigurations,
product names, and impact metrics.</p>
</li>
<li>
<p>SCAP is a suite of specifications that standardize the format and nomenclature by which security software products communicate software flaw and security configuration information</p>
</li>
</ul>
</div>
</li>
<li>
<p>The <a href="http://cwe.mitre.org/">CWE</a> and <a href="https://capec.mitre.org/">Common Attack Pattern Enumeration and Classification (CAPEC)</a> collections can provide a useful list of weaknesses and attack approaches to drive a binary or live system penetration test.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="recommendation_2">5.2.4. Recommendation</h4>
<div class="ulist">
<ul>
<li>
<p>Review licensing agreements associated with analyzers and understand the security implications surrounding the integrity, intellectual property, and licensing issues when submitting an app to an analyzer.</p>
</li>
<li>
<p>Ensure that apps transmitted over the network use an encrypted channel (e.g., SSL) and that apps are stored on a secure machine at the analyzer&#8217;s location. In addition, ensure that only authorized users have access to that machine.</p>
</li>
<li>
<p>Identify general app security requirements needed by the organization.</p>
</li>
<li>
<p>Select appropriate testing tools and methodologies for determining the satisfaction or violation of general app security requirements.</p>
</li>
<li>
<p>Ensure that app updates are tested.</p>
</li>
<li>
<p>Leverage existing testing results where possible.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="app_approval_rejection">5.3. App Approval/Rejection</h3>
<div class="sect3">
<h4 id="report_and_risk_auditing">5.3.1. Report and Risk Auditing</h4>
<div class="ulist">
<ul>
<li>
<p>One of the main issues related to report and risk auditing stems from the difficulty in collating and interpreting different reports and risk assessments from multiple analyzers due to the wide variety of security-related definitions, semantics, nomenclature, and metrics</p>
<div class="ulist">
<ul>
<li>
<p>It is recommended that an organization identify analyzers that leverage vulnerability reporting and risk assessment standards.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="organization_specific_vetting_criteria">5.3.2. Organization-Specific Vetting Criteria</h4>
<div class="paragraph">
<p>Sample criterias:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Requirements</p>
</li>
<li>
<p>Provenance</p>
</li>
<li>
<p>Data Sensitivity</p>
</li>
<li>
<p>App Criticality</p>
</li>
<li>
<p>Target Users</p>
</li>
<li>
<p>Target Hardware</p>
</li>
<li>
<p>Target Environment</p>
</li>
<li>
<p>Digital Signature</p>
</li>
<li>
<p>App Documentation</p>
<div class="ulist">
<ul>
<li>
<p>User Guide</p>
</li>
<li>
<p>Test Plans</p>
</li>
<li>
<p>Testing Results</p>
</li>
<li>
<p>Service-Level Agreement</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="recommendation_3">5.3.3. Recommendation</h4>
<div class="ulist">
<ul>
<li>
<p>Use analyzers that leverage a standardized reporting format or risk assessment methodology, or that provides intuitive and easy-to-interpret reports and risk assessments.</p>
</li>
<li>
<p>Ensure sufficient training of auditors on both the organization&#8217;s security requirements and interpretation of analyzer reports and risk assessments. Use multiple auditors to increase likelihood of appropriate recommendations.</p>
</li>
<li>
<p>Identify organization-specific vetting criteria necessary for vetting context-sensitive app security requirements.</p>
</li>
<li>
<p>Monitor public databases, mailing lists, and other publicly available security vulnerability reporting repositories to keep abreast of new developments that may impact the security of mobile devices and mobile apps.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="niap_mobile_app_vetting">6. NIAP Mobile App Vetting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a summary of the <a href="https://www.niap-ccevs.org/pp/pp_app_v1.2_table-reqs.htm">NIAP Mobile App Vetting</a> Guidelines.</p>
</div>
<div class="sect2">
<h3 id="security_functional_requirements">6.1. Security Functional Requirements</h3>
<div class="sect3">
<h4 id="random_bit_generation_services">6.1.1. Random Bit Generation Services</h4>
<div class="paragraph">
<p>The Application should select from the following approaches for its cryptographic operations:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; use no DRBG functionality</p>
</li>
<li>
<p>&#10063; invoke platform-provided DRBG functionality</p>
</li>
<li>
<p>&#10063; implement DRBG functionality</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>DRBG</em>: Deterministic Random Bit Generator (aka RNG, PRNG) based HMACs, Hashes, and Ciphers. In this requirement, cryptographic operations include all cryptographic key generation/derivation/agreement, IVs (for certain modes), as well as protocol-specific random values.</p>
</div>
</div>
<div class="sect3">
<h4 id="storage_of_credentials">6.1.2. Storage of Credentials</h4>
<div class="paragraph">
<p>The Application should select from the following approaches for storage of credentials in non-volatile memory:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; not store any credentials</p>
</li>
<li>
<p>&#10063; invoke the functionality provided by the platform to securely store credentials</p>
</li>
<li>
<p>&#10063; implement functionality to securely store credentials</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This requirement ensures that persistent credentials like secret keys, PKI private keys, or passwords are stored in a secure manner.</p>
</div>
</div>
<div class="sect3">
<h4 id="access_to_platform_resources">6.1.3. Access to Platform Resources</h4>
<div class="paragraph">
<p>The application shall restrict its access to the following and additonal hardware resources:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; No Hardware Resources</p>
</li>
<li>
<p>&#10063; Network Connectivity</p>
</li>
<li>
<p>&#10063; Camera</p>
</li>
<li>
<p>&#10063; Microphone</p>
</li>
<li>
<p>&#10063; Location Services</p>
</li>
<li>
<p>&#10063; NFC</p>
</li>
<li>
<p>&#10063; USB</p>
</li>
<li>
<p>&#10063; Bluetooth</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The intent is to ensure that the selection captures all hardware resources which the application accesses, and that these are restricted to those which are required or used by the application.</p>
</div>
<div class="paragraph">
<p>The application shall also restrict its access to the following and additonal sensitive information repositories:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; No Sensitive Information Repositories</p>
</li>
<li>
<p>&#10063; Address Book</p>
</li>
<li>
<p>&#10063; Calendar</p>
</li>
<li>
<p>&#10063; Call Lists</p>
</li>
<li>
<p>&#10063; System Logs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sensitive information repositories are defined as those collections of sensitive data that could be expected to be shared among some applications, users, or user roles, but to which not all of these would ordinarily require access.</p>
</div>
</div>
<div class="sect3">
<h4 id="network_communications">6.1.4. Network Communications</h4>
<div class="paragraph">
<p>The application shall restrict network communication to the following and additional application-initiated communications:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; No Network Communication</p>
</li>
<li>
<p>&#10063; User-initiated Communication for the list of Functions for which the User can Initiate Network Communication</p>
</li>
<li>
<p>&#10063; Respond to Remotely Initiated Communications</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This requirement is intended to restrict both inbound/outbound network communications to only those required, or to those initiated by the user.</p>
</div>
</div>
<div class="sect3">
<h4 id="encryption_of_sensitive_application_data">6.1.5. Encryption Of Sensitive Application Data</h4>
<div class="paragraph">
<p>The Application should select from the following approaches for storage of sensitive data in non-volatile memory:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Leverage Platform-provided Functionality to Encrypt Sensitive Data</p>
</li>
<li>
<p>&#10063; Implement Functionality to Encrypt Sensitive Data</p>
</li>
<li>
<p>&#10063; Not Store any Sensitive Data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any file that may potentially contain sensitive data shall be protected.
The only exception is if the user intentionally exports the sensitive data to non-protected files.</p>
</div>
</div>
<div class="sect3">
<h4 id="supported_configuration_mechanism">6.1.6. Supported Configuration Mechanism</h4>
<div class="paragraph">
<p>The application shall invoke the mechanisms recommended by the platform or framework vendor for storing and setting configuration options.</p>
</div>
</div>
<div class="sect3">
<h4 id="secure_by_default_configuration">6.1.7. Secure by Default Configuration</h4>
<div class="paragraph">
<p>The application shall be configured by default with file permissions which protect it and its data from unauthorized access.
There should be some form of trust boundary which protects the application and its data.</p>
</div>
</div>
<div class="sect3">
<h4 id="specification_of_management_functions">6.1.8. Specification of Management Functions</h4>
<div class="paragraph">
<p>The TSF (Target of Evaluation Security Functionality) shall be capable of performing the following management functions:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; No Management functions.</p>
</li>
<li>
<p>&#10063; Enable/Disable the Transmission of any information describing the system&#8217;s hardware, software, or configuration</p>
</li>
<li>
<p>&#10063; Enable/Disable the Transmission of any PII (Personally Identifiable Information)</p>
</li>
<li>
<p>&#10063; Enable/Disable the Transmission of any application state (e.g. crashdump) information</p>
</li>
<li>
<p>&#10063; Enable/Disable network backup functionality to enterprise or commercial cloud backup systems</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>TOE (Target of Evaluation) security functionality is the “combined functionality of all hardware, software, and firmware of a TOE that must be relied upon for the correct enforcement of the security functional requirements.</p>
</div>
</div>
<div class="sect3">
<h4 id="user_consent_for_transmission_of_personally_identifiable_information">6.1.9. User Consent for Transmission of Personally Identifiable Information</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Not Transmit PII over a Network</p>
</li>
<li>
<p>&#10063; Require User Approval before Executing a Function that Transmits PII over a Network</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This requirement applies only to PII that is specifically requested by the application;
it does not apply if the user volunteers PII without prompting from the application into a general (or inappropriate) data field.
A dialog box that declares intent to send PII presented to the user when the application is started is sufficient to meet this requirement.</p>
</div>
</div>
<div class="sect3">
<h4 id="use_of_supported_services_and_apis">6.1.10. Use of Supported Services and APIs</h4>
<div class="paragraph">
<p>The application shall use only documented platform APIs.</p>
</div>
</div>
<div class="sect3">
<h4 id="anti_exploitation_capabilities">6.1.11. Anti-Exploitation Capabilities</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Not allocate any memory region with both write and execute permissions</p>
</li>
<li>
<p>&#10063; Allocate memory regions with write and execute permissions for only a specified list of functions performing just-in-time compilation</p>
<div class="ulist">
<ul>
<li>
<p>Requesting a memory mapping with both write and execute permissions subverts the platform protection provided by DEP.</p>
<div class="ulist">
<ul>
<li>
<p>The application shall be compatible with security features provided by the platform vendor.</p>
</li>
</ul>
</div>
</li>
<li>
<p>This requirement is designed to ensure that platform security features do not need to be disabled in order for the application to run.</p>
<div class="ulist">
<ul>
<li>
<p>The application shall not write user-modifiable files to directories that contain executable files unless explicitly directed by the user to do so.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Executables and user-modifiable files may not share the same parent directory, but may share directories above the parent.</p>
<div class="ulist">
<ul>
<li>
<p>The application shall be compiled with stack-based buffer overflow protection enabled.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="integrity_for_installation_and_update">6.1.12. Integrity for Installation and Update</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Provide the ability or leverage the platform to check for updates and patches to the application software.</p>
</li>
<li>
<p>&#10063; Be distributed using the format of the platform-supported package manager.</p>
</li>
<li>
<p>&#10063; Be packaged such that its removal results in the deletion of all traces of the application, with the exception of configuration settings, output files, and audit/log events.</p>
</li>
<li>
<p>&#10063; Not download, modify, replace or update its own binary code.</p>
</li>
<li>
<p>&#10063; Provide the ability or leverage the platform to query the current version of the application software.</p>
</li>
<li>
<p>&#10063; Ensure that the installation package and its updates shall be digitally signed such that its platform can cryptographically verify them prior to installation.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="use_of_third_party_libraries">6.1.13. Use of Third Party Libraries</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Be packaged with only third-party libraries that are required and vulnerability free.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="protection_of_data_in_transit">6.1.14. Protection of Data in Transit</h4>
<div class="paragraph">
<p>The application shall use one or more of the approaches for transmitting between itself and another trusted IT product:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Not Transmit any Data</p>
</li>
<li>
<p>&#10063; Not Transmit any Sensitive Data</p>
</li>
<li>
<p>&#10063; Encrypt all transmitted sensitive data with at least one of the following: HTTPS, TLS, DTLS, SSH</p>
</li>
<li>
<p>&#10063; Encrypt all transmitted data with at least one of the following: HTTPS, TLS, DTLS, SSH</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="security_assurance_requirements">6.2. Security Assurance Requirements</h3>
<div class="paragraph">
<p>The application shall be labeled with a unique references:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Application Name</p>
</li>
<li>
<p>&#10063; Application Version</p>
</li>
<li>
<p>&#10063; Application Description</p>
</li>
<li>
<p>&#10063; Platform on which Application Runs</p>
</li>
<li>
<p>&#10063; Software Identification (SWID) tags, if available</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="selection_based_security_functional_requirements">6.3. Selection-Based Security Functional Requirements</h3>
<div class="sect3">
<h4 id="random_bit_generation_from_application">6.3.1. Random Bit Generation from Application</h4>
<div class="paragraph">
<p>The application shall perform all deterministic random bit generation (DRBG) services in accordance with <a href="http://csrc.nist.gov/publications/nistpubs/800-90A/SP800-90A.pdf">NIST Special Publication 800-90A</a> using any of the following:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Hash_DRBG (any)</p>
</li>
<li>
<p>&#10063; HMAC_DRBG (any)</p>
</li>
<li>
<p>&#10063; CTR_DRBG (AES)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The deterministic RBG shall be seeded by an entropy source that accumulates entropy from a platform-based DRBG and a:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; A software-based noise source</p>
</li>
<li>
<p>&#10063; No other noise source</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>with a minimum of:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; 128 bits</p>
</li>
<li>
<p>&#10063; 256 bits</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>of entropy at least equal to the greatest security strength (according to <a href="http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf">NIST SP 800-57</a>) of the keys and hashes that it will generate.</p>
</div>
</div>
<div class="sect3">
<h4 id="cryptographic_key_generation_services">6.3.2. Cryptographic Key Generation Services</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Generate no asymmetric cryptographic keys</p>
</li>
<li>
<p>&#10063; Invoke platform-provided functionality for asymmetric key generation</p>
</li>
<li>
<p>&#10063; Implement asymmetric key generation</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cryptographic_asymmetric_key_generation">6.3.3. Cryptographic Asymmetric Key Generation</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Generate asymmetric cryptographic keys in accordance with a specified cryptographic key generation algorithm</p>
<div class="ulist">
<ul>
<li>
<p>An RSA scheme using cryptographic key sizes of 2048-bit or greater that meet the following:</p>
<div class="ulist">
<ul>
<li>
<p>FIPS PUB 186-4, “Digital Signature Standard (DSS)”</p>
</li>
<li>
<p>ANSI X9.31-1998</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cryptographic_operation_encryption_decryption">6.3.4. Cryptographic Operation - Encryption/Decryption</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Perform encryption/decryption in accordance with a specified cryptographic algorithm:</p>
<div class="ulist">
<ul>
<li>
<p>AES-CBC</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AES-GCM</p>
</li>
<li>
<p>No other modes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>with cryptographic key sizes of 256-bit.</p>
</div>
</div>
<div class="sect3">
<h4 id="cryptographic_operation_hashing">6.3.5. Cryptographic Operation - Hashing</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Perform cryptographic hashing services in accordance with a specified cryptographic algorithm:</p>
<div class="ulist">
<ul>
<li>
<p>SHA-1</p>
</li>
<li>
<p>SHA-256</p>
</li>
<li>
<p>SHA-384</p>
</li>
<li>
<p>SHA-512</p>
</li>
<li>
<p>No other algorithms</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>and message digest sizes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>160</p>
</li>
<li>
<p>256</p>
</li>
<li>
<p>384</p>
</li>
<li>
<p>512</p>
</li>
<li>
<p>No other message digest sizes</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cryptographic_operation_signing">6.3.6. Cryptographic Operation - Signing</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Perform cryptographic signature services (generation and verification) in accordance with a specified cryptographic algorithm:</p>
<div class="ulist">
<ul>
<li>
<p>RSA schemes using cryptographic key sizes of 2048-bit or greater that meet the following: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">FIPS PUB 186-4, “Digital Signature Standard (DSS)”, Section 4</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cryptographic_operation_keyed_hash_message_authentication">6.3.7. Cryptographic Operation - Keyed-Hash Message Authentication</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Perform keyed-hash message authentication in accordance with a specified cryptographic algorithm:</p>
<div class="ulist">
<ul>
<li>
<p>HMAC-SHA-256</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SHA-1</p>
</li>
<li>
<p>SHA-384</p>
</li>
<li>
<p>SHA-512</p>
</li>
<li>
<p>No other algorithms</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>with key sizes the same length as thouser used in HMAC (in bits) and message digest sizes 256 and</p>
</div>
<div class="ulist">
<ul>
<li>
<p>160</p>
</li>
<li>
<p>384</p>
</li>
<li>
<p>512</p>
</li>
<li>
<p>No other sizes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>bits that meet the following: <a href="http://csrc.nist.gov/publications/fips/fips198-1/FIPS-198-1_final.pdf">FIPS Pub 198-1</a> The Keyed-Hash Message Authentication Code and <a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">FIPS Pub 180-4</a> Secure Hash Standard.</p>
</div>
</div>
<div class="sect3">
<h4 id="tls_client_protocol">6.3.8. TLS Client Protocol</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Invoke platform-provided TLS 1.2</p>
</li>
<li>
<p>&#10063; Implement TLS 1.2 (RFC 5246)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>supporting the following cipher suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mandatory Cipher Suites: TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optional Cipher Suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5246">RFC 5246</a></p>
</li>
<li>
<p>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5246">RFC 5246</a></p>
</li>
<li>
<p>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5246">RFC 5246</a></p>
</li>
<li>
<p>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5246">RFC 5246</a></p>
</li>
<li>
<p>No other cipher suite</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Verify that the presented identifier matches the reference identifier according to <a href="https://tools.ietf.org/html/rfc6125">RFC 6125</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Establish a trusted channel only if the peer certificate is valid.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="tls_server_protocol">6.3.9. TLS Server Protocol</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Invoke platform-provided TLS 1.2</p>
</li>
<li>
<p>&#10063; Implement TLS 1.2 (RFC 5246)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>supporting the following cipher suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mandatory Cipher Suites: TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optional Cipher Suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5246">RFC 5246</a></p>
</li>
<li>
<p>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5246">RFC 5246</a></p>
</li>
<li>
<p>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in <a href="https://tools.ietf.org/html/rfc5289">RFC 5289</a></p>
</li>
<li>
<p>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5246">RFC 5246</a></p>
</li>
<li>
<p>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in <a href="https://tools.ietf.org/html/rfc5246">RFC 5246</a></p>
</li>
<li>
<p>No other cipher suite</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Deny connections from clients requesting:</p>
<div class="ulist">
<ul>
<li>
<p>SSL 2.0</p>
</li>
<li>
<p>SSL 3.0</p>
</li>
<li>
<p>TLS 1.0</p>
</li>
<li>
<p>TLS 1.1</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Support mutual authentication of TLS clients using X.509 v3 certificates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Not establish a trusted channel if the peer certificate is invalid.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Not establish a trusted channel if the distinguished name (DN) or Subject Alternative Name (SAN) contained in a certificate does not match the expected identifier for the peer.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dtls_implementation">6.3.10. DTLS Implementation</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Implement the DTLS protocol in accordance with DTLS 1.2 (<a href="https://tools.ietf.org/html/rfc6347">RFC 6347</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Implement the requirements in TLS (FCS_TLSC_EXT.1) for the DTLS implementation, except where variations are allowed according to DTLS 1.2 (<a href="https://tools.ietf.org/html/rfc6347">RFC 6347</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Not establish a trusted communication channel if the peer certificate is deemed invalid.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="https_protocol">6.3.11. HTTPS Protocol</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Implement the HTTPS protocol that complies with <a href="https://tools.ietf.org/html/rfc2818">RFC 2818</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Implement HTTPS using TLS (<a href="https://www.niap-ccevs.org/pp/pp_app_v1.2_table-reqs.htm#FCS_TLSC_EXT.1">FCS_TLSC_EXT.1</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Notify the user and</p>
<div class="ulist">
<ul>
<li>
<p>Not establish the connection</p>
</li>
<li>
<p>Request application authorization to establish the connection</p>
</li>
<li>
<p>No other action</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>if the peer certificate is deemed invalid.</p>
</div>
</div>
<div class="sect3">
<h4 id="x_509_certificate_validation">6.3.12. X.509 Certificate Validation</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Invoked platform-provided functionality</p>
</li>
<li>
<p>&#10063; Implement functionality</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>to validate certificates in accordance with the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc5280">RFC 5280</a> certificate validation and certificate path validation.</p>
</li>
<li>
<p>The certificate path must terminate with a trusted CA certificate.</p>
</li>
<li>
<p>The application shall validate a certificate path by ensuring the presence of the basicConstraints extension and that the CA flag is set to TRUE for all CA certificates.</p>
</li>
<li>
<p>The application shall:</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Validate the revocation status of the certificate using:</p>
<div class="ulist">
<ul>
<li>
<p>The Online Certificate Status Protocol (OCSP) as specified in <a href="https://tools.ietf.org/html/rfc2560">RFC 2560</a></p>
</li>
<li>
<p>A Certificate Revocation List (CRL) as specified in <a href="https://tools.ietf.org/html/rfc5759">RFC 5759</a> , an OCSP TLS Status Request Extension (i.e., OCSP stapling) as specified in <a href="https://tools.ietf.org/html/rfc6066">RFC 6066</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The application shall validate the extendedKeyUsage field according to the following rules:</p>
<div class="ulist">
<ul>
<li>
<p>Certificates used for trusted updates and executable code integrity verification shall have the Code Signing purpose (id-kp 3 with OID 1.3.6.1.5.5.7.3.3) in the extendedKeyUsage field.</p>
</li>
<li>
<p>Server certificates presented for TLS shall have the Server Authentication purpose (id-kp 1 with OID 1.3.6.1.5.5.7.3.1) in the extendedKeyUsage field.</p>
</li>
<li>
<p>Client certificates presented for TLS shall have the Client Authentication purpose (id-kp 2 with OID 1.3.6.1.5.5.7.3.2) in the extendedKeyUsage field.</p>
</li>
<li>
<p>S/MIME certificates presented for email encryption and signature shall have the Email Protection purpose (id-kp 4 with OID 1.3.6.1.5.5.7.3.4) in the extendedKeyUsage field.</p>
</li>
<li>
<p>OCSP certificates presented for OCSP responses shall have the OCSP Signing purpose (id-kp 9 with OID 1.3.6.1.5.5.7.3.9) in the extendedKeyUsage field.</p>
</li>
<li>
<p>Server certificates presented for EST shall have the CMC Registration Authority (RA) purpose (id-kp-cmcRA with OID 1.3.6.1.5.5.7.3.28) in the extendedKeyUsage field.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Treat a certificate as a CA certificate only if the basicConstraints extension is present and the CA flag is set to TRUE.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="x_509_certificate_authentication">6.3.13. X.509 Certificate Authentication</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Use X.509v3 certificates as defined by RFC 5280 to support authentication for:</p>
<div class="ulist">
<ul>
<li>
<p>HTTPS</p>
</li>
<li>
<p>TLS</p>
</li>
<li>
<p>DTLS</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the application cannot establish a connection to determine the validity of a certificate, the application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Allow the administrator to choose whether to accept the certificate in these cases</p>
</li>
<li>
<p>&#10063; Accept the certificate</p>
</li>
<li>
<p>&#10063; Not accept the certificate</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="objective_security_functional_requirements">6.4. Objective Security Functional Requirements</h3>
<div class="sect3">
<h4 id="tls_client_protocol_2">6.4.1. TLS Client Protocol</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Present the signature_algorithms extension in the Client Hello with the supported_signature_algorithms value containing the following hash algorithms:</p>
<div class="ulist">
<ul>
<li>
<p>SHA256</p>
</li>
<li>
<p>SHA384</p>
</li>
<li>
<p>SHA512</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>and no other hash algorithms.</p>
</div>
</div>
<div class="sect3">
<h4 id="use_of_supported_services_and_apis_2">6.4.2. Use of Supported Services and APIs</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Use platform-provided libraries, does not implement functionality for parsing the list of formats parsed that are included in the <a href="http://www.iana.org/assignments/media-types">IANA MIME media types</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="software_identification_and_versions">6.4.3. Software Identification and Versions</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Include SWID tags that comply with the minimum requirements for SWID tag from <a href="https://www.iso.org/standard/53670.html">ISO/IEC 19770-2:2009 standard</a>.</p>
<div class="ulist">
<ul>
<li>
<p>Valid SWID tags must contain a SoftwareIdentity element and an Entity element as defined in the <a href="https://www.iso.org/standard/53670.html">ISO/IEC 19770-2:2009 standard</a>. SWID tags must be stored with a .swidtag file extensions as defined in the ISO/IEC 19770-2:2009.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="optional_security_functional_requirements">6.5. Optional Security Functional Requirements</h3>
<div class="sect3">
<h4 id="cryptographic_symmetric_key_generation">6.5.1. Cryptographic Symmetric Key Generation</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Generate symmetric cryptographic keys using a Random Bit Generator as specified in FCS_RBG_EXT.1 and specified cryptographic key sizes:</p>
<div class="ulist">
<ul>
<li>
<p>128 bit</p>
</li>
<li>
<p>256 bit</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="tls_client_protocol_3">6.5.2. TLS Client Protocol</h4>
<div class="paragraph">
<p>The application shall:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10063; Support mutual authentication using X.509v3 certificates.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guidelines_for_managing_the_security_of_mobile_devices_in_the_enterprise">7. Guidelines for Managing the Security of Mobile Devices in the Enterprise</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a summary of notes taken from the <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-124r1.pdf">NIST Guidelines for Managing the Security of Mobile Devices in the Enterprise</a>.</p>
</div>
<div class="sect2">
<h3 id="high_level_threats_and_vulnerabilities_for_mobile_devices">7.1. High-Level Threats and Vulnerabilities for Mobile Devices</h3>
<div class="sect3">
<h4 id="lack_of_physical_security_controls">7.1.1. Lack of Physical Security Controls</h4>
<div class="sect4">
<h5 id="mitigations">Mitigations</h5>
<div class="ulist">
<ul>
<li>
<p>Requiring authentication before gaining access to the mobile device or the organization’s resources accessible through the device.</p>
</li>
<li>
<p>Protecting sensitive data—either encrypting the mobile device’s storage so that sensitive data cannot be recovered from it by unauthorized parties, or not storing sensitive data on mobile devices.</p>
</li>
<li>
<p>User training and awareness, to reduce the frequency of insecure physical security practices.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_of_untrusted_mobile_devices">7.1.2. Use of Untrusted Mobile Devices</h4>
<div class="sect4">
<h5 id="mitigations_2">Mitigations</h5>
<div class="ulist">
<ul>
<li>
<p>Restrict or prohibit use of BYOD devices, thus favoring organization-issued devices</p>
</li>
<li>
<p>Fully secure each organization-issued mobile device; this gets the mobile device in as trusted a state as possible, and deviations from this secure state can be monitored and addressed.</p>
</li>
<li>
<p>Use other technical solutions for achieving degrees of trust in BYOD devices</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_of_untrusted_networks">7.1.3. Use of Untrusted Networks</h4>
<div class="sect4">
<h5 id="mitigations_3">Mitigations</h5>
<div class="ulist">
<ul>
<li>
<p>Using strong encryption technologies (such as virtual private networks, VPNs) to protect the confidentiality and integrity of communications</p>
</li>
<li>
<p>Using mutual authentication mechanisms to verify the identities of both endpoints before transmitting data</p>
</li>
<li>
<p>Prohibit use of insecure Wi-Fi networks</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_of_untrusted_applications">7.1.4. Use of Untrusted Applications</h4>
<div class="sect4">
<h5 id="mitigations_4">Mitigations</h5>
<div class="ulist">
<ul>
<li>
<p>Prohibiting all installation of thirdparty applications, or implementing whitelisting to allow installation of approved applications only.</p>
</li>
<li>
<p>Perform a risk assessment on each third-party application before permitting its use on the organization’s mobile devices</p>
</li>
<li>
<p>Prohibiting or restricting browser access</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="interaction_with_other_systems">7.1.5. Interaction with Other Systems</h4>
<div class="sect4">
<h5 id="mitigations_5">Mitigations</h5>
<div class="ulist">
<ul>
<li>
<p>Preventing an organization-issued mobile device from syncing with a personally-owned computer necessitates security controls on the mobile device that restrict what devices it can synchronize with</p>
</li>
<li>
<p>Preventing a personally-owned mobile device from syncing with an organization-issued computer necessitates security controls on the organizationissued computer, restricting the connection of mobile devices</p>
</li>
<li>
<p>Preventing the use of remote backup services can possibly be achieved by blocking use of those services or by configuring the mobile devices not to use such services</p>
</li>
<li>
<p>Users should be instructed not to connect their mobile devices to unknown charging devices; they should carry and use their own charging devices</p>
</li>
<li>
<p>Mobile devices can be prevented from exchanging data with each other through logical or physical means</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_of_untrusted_content">7.1.6. Use of Untrusted Content</h4>
<div class="sect4">
<h5 id="mitigations_6">Mitigations</h5>
<div class="ulist">
<ul>
<li>
<p>Educate users on the risks inherent in untrusted content and to discourage users from accessing untrusted content with any mobile devices they use for work</p>
</li>
<li>
<p>Have applications, such as QR readers, display the unobfuscated content (e.g., the URL) and allow users to accept or reject it before proceeding</p>
</li>
<li>
<p>Use secure web gateways, HTTP proxy servers, or other intermediate devices to validate URLs before allowing them to be contacted.</p>
</li>
<li>
<p>It is also possible to restrict peripheral use on mobile devices, such as disabling camera use in order to prevent QR codes from being processed</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="use_of_location_services">7.1.7. Use of Location Services</h4>
<div class="sect4">
<h5 id="mitigations_7">Mitigations</h5>
<div class="ulist">
<ul>
<li>
<p>Disabling location services or by prohibiting use of location services for particular applications such as social networking or photo applications.</p>
</li>
<li>
<p>Users may also be trained to turn off location services when in sensitive areas</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="technologies_for_mobile_device_management">7.2. Technologies for Mobile Device Management</h3>
<div class="paragraph">
<p>The MDM system should have the following capabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>General policy</p>
<div class="ulist">
<ul>
<li>
<p>Restrict user and application access to hardware</p>
</li>
<li>
<p>Restrict user and application access to native OS services</p>
</li>
<li>
<p>Manage wireless network interfaces</p>
</li>
<li>
<p>Automatically monitor, detect, and report when policy violations occur</p>
</li>
<li>
<p>Limit or prevent access to enterprise services based on the mobile device’s operating system version</p>
</li>
</ul>
</div>
</li>
<li>
<p>Data Communication and Storage</p>
<div class="ulist">
<ul>
<li>
<p>Strongly encrypt data communications between the mobile device and the organization.</p>
</li>
<li>
<p>Strongly encrypt stored data on both built-in storage and removable media storage.</p>
</li>
<li>
<p>Wipe the device (to scrub its stored data) before reissuing it to another user, retiring the device, etc.</p>
</li>
<li>
<p>Remotely wipe the device (to scrub its stored data) if it is suspected that the device has been lost, stolen, or otherwise fallen into untrusted hands and is at risk of having its data recovered by an untrusted party.</p>
</li>
<li>
<p>A device often can also be configured to wipe itself after a certain number of incorrect authentication attempts.</p>
</li>
</ul>
</div>
</li>
<li>
<p>User and Device Authentication</p>
<div class="ulist">
<ul>
<li>
<p>Require a device password/passcode and/or other authentication (e.g., token-based authentication, network-based device authentication, domain authentication) before accessing the organization’s resources.</p>
</li>
<li>
<p>If device account lockout is enabled or the device password/passcode is forgotten, an administrator can reset this remotely to restore access to the device.</p>
</li>
<li>
<p>Have the device automatically lock itself after it is idle for a period</p>
</li>
<li>
<p>Under the direction of an administrator, remotely lock the device if it is suspected that the device has been left in an unlocked state in an unsecured location</p>
</li>
</ul>
</div>
</li>
<li>
<p>Applications</p>
<div class="ulist">
<ul>
<li>
<p>Restrict which app stores may be used.</p>
</li>
<li>
<p>Restrict which applications may be installed through whitelisting (preferable) or blacklisting.</p>
</li>
<li>
<p>Restrict the permissions (e.g., camera access, location access) assigned to each application.</p>
</li>
<li>
<p>Install, update, and remove applications.</p>
</li>
<li>
<p>Restrict the use of operating system and application synchronization services (e.g., local device synchronization, remote synchronization services and websites).</p>
</li>
<li>
<p>Verify digital signatures on applications to ensure that only applications from trusted entities are installed on the device and that code has not been modified.</p>
</li>
<li>
<p>Distribute the organization’s applications from a dedicated mobile application store</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-08-15 10:18:46 IST
</div>
</div>
</body>
</html>